# GLMの応用範囲をひろげる

## 二項分布

N C y q^y (1 - q)~(N - y)

確率qで発生する事象が、N回中y回起きる確率。

## ロジスティック関数

qi = logistic(zi) = 1 / (1 + exp(-zi))

## ロジット関数

logit(qi) = log (qi / (1 - qi)) = zi

ロジスティック関数の逆関数。

## 相互作用項

logit(qi) = b1 + b2xi + b3fi + b4xifi

変数の積を線形予測子に入れると変数間の相互作用を表現できる。

## オフセット項わざ

観測データの割算をしないで済ませる技法。

### ポアソン回帰の例

λi = Ai zi = Ai exp(b1 + b2 xi) = exp(b1 + b2 xi + log Ai)

λi ポアソン分布のパラメータ、何かの平均個体数、観測データ
Ai 面積、λi / Ai は面積あたりの平均個体数になる、観測データ
zi 人口密度
log Ai オフセット項、これを使えば λi / Ai という観測データ同士の割算を推定しなくてもよくなる

## 正規分布とその尤度

L(μ,σ) = Πp(yi|μ,σ) = Π1/sqrt(2πσ^2) exp(-(yi - μ)^2/ 2σ^2) Δy

log L(μ,σ) = -0.5N log(2πσ^2) - 1 / 2σ^2 Σ(yi-μ)^2 + Nlog(Δy)

これを最小にするのは、最小二乗法でパラメータ推定するのと一緒。

## ガンマ分布

p(y|s,r) = (r^s / Γ(s)) y^(s - 1) exp(-ry)

Γ(s) はガンマ関数。
平均 s/r
分散 s/r^2

## ガンマ分布のGLM

yiが平均μiのガンマ分布にしたがっているとする。

μi = A xi^b = exp(a)xi^b = exp(a + b log xi)

log μi = a + b log xi

aとbが推定されるパラメータ

## デモ
