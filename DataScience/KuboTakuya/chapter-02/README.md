# 確率分布と統計モデルの最尤推定の読書メモ

## ポアソン分布

p(y|λ) = λ^y exp(-λ) / y!

- y ∈ { 0, 1, 2, ..., ∞ }
- λ >= 0
- λ=平均=分散

## 最尤推定

実際に得られているデータを生成する確率が最も高くなるように、分布のパラメータを選ぶ推定方法。

### 尤度

データがある分布から生成される確率。

例．データ Y = {y1, y2, y3, ..., yn} がポアソン分布p(y|λ)から得られる確率L(λ)は

L(λ) = p(y1|λ) * p(y2|λ) * p(y3|λ) * ... * p(yn|λ) 

簡単な場合は解析的に尤度を最大にするパラメータが求まるが、一般的には数値計算して求める。

## デモ

### 最尤推定の例

[maximum-likelihood.R](https://github.com/YuichiroSato/DataScience/blob/master/KuboTakuya/chapter-02/maximum-likelihood.R)では最尤推定を数値計算で行う様子をざっくりと見られるようにした。

まずは最尤推定に使うデータを用意する。
以下のコードで1から10までの乱数を平均に持つポアソン分布からサンプルを20用意している。

```
n <- runif(1, 1, 10)
rads <- rpois(20, lambda=n[1])
```

以下のコードで尤度を計算する。
`dpois(x, lambda=i)`はλ=iのポアソン分布からxが得られる確率。
`sum(log(prob(rads)))`は対数尤度。
確率の積をそのまま計算すると値が小さくなりすぎて計算できない。

```
prob <- function(x) {
  dpois(x, lambda=i)
}
res[i] <- sum(log(prob(rads)))
```

λは本当は0以上の実数だが、あまりに細かく計算しても結果が見づらくなるので1から10までの整数についてのみ計算した。
実行してみると、データを生成するのに使ったポアソン分布の平均に近い時に対数尤度が一番大きくなっていることが分かる。
