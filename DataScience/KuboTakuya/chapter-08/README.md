## デモ

### 同時確率と条件付き確率のデモ
[show-conditional-distribution.R](https://github.com/YuichiroSato/DataScience/blob/master/KuboTakuya/chapter-08/show-conditional-distribution.R)では同時確率と条件付き確率の関係のデモを見られるようにした。
`a` と `b` は共に二項分布するが、`b` の発生確率は `a` に比例するようにした。
実行すると以下の出力が得られる。
条件付き確率は同時確率を横、縦に1列ぶん見た確率分布だということが分かる。

```
Joint distribution, p(a,b)
a\b | 0          1               2
0   | 0.10125    0.0225  0.00125
1   | 0.24       0.12    0.015
2   | 0.18375    0.1575  0.03375
3   | 0.045      0.06    0.02

Conditional distribution, p(b|a=i)
a\b | 0          1               2
0   | 0.81       0.18    0.01
1   | 0.64       0.32    0.04
2   | 0.49       0.42    0.09
3   | 0.36       0.48    0.16

Conditional distribution, p(a|b=i)
b\a | 0                  1                       2                       3
0   | 0.177631578947368  0.421052631578947       0.322368421052632       0.0789473684210526
1   | 0.0625     0.333333333333333       0.4375  0.166666666666667
2   | 0.0178571428571429         0.214285714285714       0.482142857142857       0.285714285714286
```

### ベイズの定理のデモ

[show-bayses-theorem.R](https://github.com/YuichiroSato/DataScience/blob/master/KuboTakuya/chapter-08/show-bayses-theorem.R)ではベイズの定理のサンプルを見られるようにした。
p(a,b) = p(a|b=i) * p(b=i) = p(b|a=i) * p(a=i)が見てとれる。

```
Joint distribution, p(a,b)
a\b | 0          1               2
0   | 0.10125    0.0225  0.00125
1   | 0.24       0.12    0.015
2   | 0.18375    0.1575  0.03375
3   | 0.045      0.06    0.02

Joint distribution, p(a|b=i) * p(b=i)
a\b | 0          1               2
0   | 0.10125    0.0225  0.00125
1   | 0.24       0.12    0.015
2   | 0.18375    0.1575  0.03375
3   | 0.045      0.06    0.02

Joint distribution, p(b|a=i) * p(a=i)
a\b | 0          1               2
0   | 0.10125    0.0225  0.00125
1   | 0.24       0.12    0.015
2   | 0.18375    0.1575  0.03375
3   | 0.045      0.06    0.02
```

### 事後確率のデモ

[plot-one-d-posterior.R](https://github.com/YuichiroSato/DataScience/blob/master/KuboTakuya/chapter-08/plot-one-d-posterior.R)ではデータが一つだけある時の事後確率を計算するデモを見られるようにした。
尤度 `p(y|q)` は平均 `q` のポアソン分布をするとして、`q` の事前分布は二項分布にした。
これで `y` と `q` の同時確率が計算できるから、ベイズの定理から事後確率 `p(q|y)` が計算できる。
計算してみると、概ね `y` が大きな値を取るときに `q` も大きな値を取る確率が高くなるのが分かる。
`y` が大きな値を取るなら、`y` を生成したポアソン分布の平均も大きな値である場合が多いだろうから、妥当な結果であることが分かる。

### 事後確率のデモ２

[plot-multi-d-posterior.R](https://github.com/YuichiroSato/DataScience/blob/master/KuboTakuya/chapter-08/plot-multi-d-posterior.R)ではデータが複数ある場合の事後確率を計算するデモを見られるようにした。
さっきはデータの数は1つだったが、今回は3つで同じことをやる。
尤度は3つの `y` が平均 `q` のポアソン分布から得られる確率の積になる。
やはりデータに大きな `y` が含まれている場合に `q` が大きな値を取るときに確率が高くなる。

### 事前分布に一様分布を使った場合のメトロポリス法サンプリング

[plot-metro-uniform-prior.R](https://github.com/YuichiroSato/DataScience/blob/master/KuboTakuya/chapter-08/plot-metro-uniform-prior.R)ではメトロポリス法の事前分布に一様分布を使った場合のメトロポリス法のデモを見られるようにした。
データ `Y` を平均 `5` 分散 `1` の正規分布から生成し、尤度を平均 `q` 分散 `1` の正規分布を使って計算し `p(q|Y)` をメトロポリス法によってサンプリングした。
事前分布には一様分布を仮定し、尤度だけを使ってサンプリングした場合と事前分布をかけた場合を比べてみた。
事前分布が一様分布の場合は尤度に事後分布をかけてもかけなくても同じ分布に収束するのが分かる。

### 事前分布に一様分布でない分布を使った場合のメトロポリス法サンプリング

[plot-metro-prior.R](https://github.com/YuichiroSato/DataScience/blob/master/KuboTakuya/chapter-08/plot-metro-prior.R)では事前分布が一様分布でない場合のメトロポリス法のデモを見られるようにした。
データは `Y` は平均 `q` 分散 `1` の正規分布から得られる。
しかし、データを生成する正規分布の平均 `q` は `3` または `7` を中心にした分散 `0.1` の正規分布から得られる。
なので、`q` の事前分布は一様分布ではない。
`p(q|Y)` をサンプリングするのに、尤度として正規分布への当てはまりの良さだけを使うと、`q` は平均約 `5` の正規分布に収束する。
事前分布としてふたこぶの正規分布を使うと、正しくふたこぶの正規分布に収束する。
もちろん、事前分布として一様分布を使い、尤度の方にふたこぶの正規分布を使ってもうまくいく。
